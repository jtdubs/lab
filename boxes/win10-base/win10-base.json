{
    "variables": {
        "iso_path": "iso/Windows.iso",
        "iso_checksum": "7f96789d08835d37b5886f81f1887a38617453a5211e788964553f4194d8b23c"
    },

    "builders": [
        {
            "type": "vmware-iso",
            "disk_size": 32768,
            "disk_type_id": 0,
            "iso_url": "{{ user `iso_path` }}",
            "iso_checksum": "sha256:{{ user `iso_checksum` }}",
            "floppy_files": [
                "unattend/vmware/autounattend.xml",
                "scripts/Set-Network.ps1",
                "scripts/Install-Updates.ps1",
                "scripts/Enable-WinRM.ps1"
            ],
            "http_directory": "tools",
            "cpus": 4,
            "cores": 4,
            "memory": 4096,
            "network": "vmnet8",
            "headless": false,
            "communicator": "winrm",
            "winrm_username": "packer",
            "winrm_password": "packer",
            "winrm_timeout": "60m",
            "boot_wait": "2s",
            "boot_command": [ "<enter>" ],
            "disk_adapter_type": "sata",
            "cdrom_adapter_type": "ide",
            "guest_os_type": "windows9-64",
            "shutdown_command": "powershell Stop-Computer",
            "vm_name": "win10-base"
        },
        {
            "type": "virtualbox-iso",
            "disk_size": 32768,
            "iso_url": "{{ user `iso_path` }}",
            "iso_checksum": "sha256:{{ user `iso_checksum` }}",
            "floppy_files": [
                "unattend/virtualbox/autounattend.xml",
                "scripts/Set-Network.ps1",
                "scripts/Install-Updates.ps1",
                "scripts/Enable-WinRM.ps1"
            ],
            "http_directory": "tools",
            "cpus": 4,
            "memory": 4096,
            "headless": false,
            "communicator": "winrm",
            "winrm_username": "packer",
            "winrm_password": "packer",
            "winrm_timeout": "60m",
            "boot_wait": "2s",
            "boot_command": [ "<enter>" ],
            "hard_drive_interface": "sata",
            "guest_os_type": "Windows10_64",
            "shutdown_command": "powershell Stop-Computer",
            "vm_name": "win10-base"
        },
        {
            "type": "hyperv-iso",
            "disk_size": 32768,
            "iso_url": "{{ user `iso_path` }}",
            "iso_checksum": "sha256:{{ user `iso_checksum` }}",
            "cd_files": [
                "unattend/hyperv/autounattend.xml",
                "scripts/Set-Network.ps1",
                "scripts/Install-Updates.ps1",
                "scripts/Enable-WinRM.ps1"
            ],
            "cd_label": "UNATTEND",
            "http_directory": "tools",
            "cpus": 4,
            "memory": 4096,
            "headless": false,
            "generation": 2,
            "switch_name": "Default Switch",
            "communicator": "winrm",
            "winrm_username": "packer",
            "winrm_password": "packer",
            "winrm_timeout": "60m",
            "boot_wait": "2s",
            "boot_command": [ "<enter>" ],
            "shutdown_command": "powershell Stop-Computer",
            "vm_name": "win10-base"
        }
    ],

    "provisioners": [
        {
            "type": "powershell",
            "scripts": [
                "scripts/Disable-AutoLogin.ps1",
                "scripts/Install-Chocolatey.ps1"
            ]
        },
        {
            "type": "powershell",
            "only": "vmware-iso",
            "scripts": [
                "scripts/Install-VMWare-Tools.ps1"
            ]
        },
        {
            "type": "powershell",
            "only": "virtualbox-iso",
            "scripts": [
                "scripts/Install-VirtualBox-Tools.ps1"
            ]
        },
        {
            "type": "windows-restart"
        }
    ],

    "post-processors": [
        {
            "type": "vagrant",
            "keep_input_artifact": true,
            "output": "win10-base-{{ .Provider }}.box"
        }
    ]
}
